{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport { of } from 'rxjs';\nimport { catchError, tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./message.service\";\nimport * as i3 from \"./sharing-service\";\nimport * as i4 from \"./login.service\";\nimport * as i5 from \"./product.service\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"./product-sharing-service\";\n/**\r\n * Methods for cart functionality, including add and remove product\r\n */\nexport class ShoppingCartService {\n  constructor(http, messageService, sharingService, userService, productService, router, productSharingService) {\n    this.http = http;\n    this.messageService = messageService;\n    this.sharingService = sharingService;\n    this.userService = userService;\n    this.productService = productService;\n    this.router = router;\n    this.productSharingService = productSharingService;\n    this.shoppingCartUrl = 'http://localhost:8080/shoppingCart';\n    this.currQuantity = 0;\n    this.httpOptions = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json'\n      })\n    };\n  }\n  /**\r\n   * directs user to their cart\r\n   */\n  navigateToCart() {\n    this.router.navigateByUrl(\"/cart\");\n  }\n  /** GET cart from the server */\n  getCart(id) {\n    const url = `${this.shoppingCartUrl}/${id}`;\n    return this.http.get(url).pipe(tap(_ => this.log('fetch shopping cart')), catchError(this.handleError('getShoppingCartError')));\n  }\n  /**\r\n   * decreases product quantity in inventory by 1\r\n   * helper for addToCartMain()\r\n   *\r\n   * @param productUpdate\r\n   */\n  updateQuantityAdd(productUpdate) {\n    let id = productUpdate.id;\n    let name = productUpdate.name;\n    let price = productUpdate.price;\n    let quantity = productUpdate.quantity - 1;\n    let description = productUpdate.description;\n    productUpdate = {\n      id,\n      name,\n      price,\n      quantity,\n      description\n    };\n    this.productService.updateProduct(productUpdate).subscribe(product => productUpdate = product);\n  }\n  /**\r\n   * Add product to user's cart and direct them to their cart\r\n   *\r\n   * @param product\r\n   */\n  addToCartMain(product) {\n    console.log(product);\n    this.currentUser = this.sharingService.getData();\n    if (this.currentUser != undefined) {\n      this.cart = this.currentUser.cart;\n      console.log(this.cart);\n      let id = product.id;\n      let name = product.name;\n      let quantity = 1;\n      let description = product.description;\n      let price = product.price;\n      let cartProduct = {\n        id,\n        name,\n        quantity,\n        price,\n        description\n      };\n      this.cart.push(cartProduct);\n      this.userService.updateUser(this.currentUser).subscribe(currentUser => this.currentUser = currentUser);\n      this.sharingService.setData(this.currentUser);\n      this.updateQuantityAdd(product);\n      this.navigateToCart();\n    }\n  }\n  /**\r\n   * returns length of cart\r\n   * @param cart\r\n   * @returns\r\n   */\n  getCartLength(cart) {\n    return cart.length;\n  }\n  /**\r\n   * Removes the product from the user's cart\r\n   *\r\n   * @param product\r\n   */\n  removeFromCart(product) {\n    this.currentUser = this.sharingService.getData();\n    let firstRemoval = this.productSharingService.getData()[1];\n    if (firstRemoval) {\n      this.currQuantity = this.productSharingService.getData()[0];\n    } else {\n      this.currQuantity++;\n    }\n    if (this.currentUser != undefined) {\n      this.cart = this.currentUser.cart;\n      length = this.getCartLength(this.cart);\n      this.updateCartQuantity(this.cart, product, this.currQuantity);\n      var i;\n      let foundType = false;\n      let foundProduct = false;\n      for (i = length - 1; i >= 0; i--) {\n        if (this.cart[i].name === product.name) {\n          if (!foundType) {\n            this.currQuantity = this.cart[i].quantity;\n            foundType = true;\n          }\n        }\n      }\n      for (i = length - 1; i >= 0; i--) {\n        if (product == this.cart[i] && !foundProduct) {\n          this.cart.splice(i, 1);\n          this.userService.updateUser(this.currentUser).subscribe(currentUser => this.currentUser = currentUser);\n          this.sharingService.setData(this.currentUser);\n          this.updateQuantityRemove(product, this.currQuantity);\n          foundProduct = true;\n        }\n      }\n    }\n  }\n  /**\r\n   * Alternate function to remove a product from the cart of the user\r\n   * @param product Product to be removed from the cart of the user\r\n   */\n  remCart(product) {\n    if (this.currentUser) {\n      let l = this.currentUser.cart.length;\n      for (let i = 0; i < l; i++) {\n        if (product.id == this.currentUser.cart[i].id) {\n          let inventoryListing;\n          this.productService.getProduct(product.id).subscribe(result => inventoryListing = result);\n          if (inventoryListing) {\n            console.log(inventoryListing);\n            inventoryListing.quantity += product.quantity;\n            console.log(inventoryListing);\n            this.currentUser.cart.splice(i, 1);\n            console.log(this.currentUser.cart[i]);\n            this.productService.updateProduct(inventoryListing);\n          }\n          break;\n        }\n      }\n    }\n  }\n  /**\r\n   * updates product with +1 quantity\r\n   * removeFromCart() helper\r\n   * @param productUpdate\r\n   * @param quantity\r\n   */\n  updateQuantityRemove(productUpdate, quantity) {\n    let id = productUpdate.id;\n    let name = productUpdate.name;\n    let price = productUpdate.price;\n    let description = productUpdate.description;\n    productUpdate = {\n      id,\n      name,\n      price,\n      quantity,\n      description\n    };\n    this.productService.updateProduct(productUpdate).subscribe(product => productUpdate = product);\n  }\n  /**\r\n   * increases the quantity of each product of the same name by 1\r\n   * @param cart\r\n   * @param product\r\n   */\n  updateCartQuantity(cart, product, quantity) {\n    let length = cart.length;\n    for (var i = length - 1; i >= 0; i--) {\n      if (product.name === cart[i].name) {\n        cart[i].quantity = quantity;\n        quantity++;\n      }\n    }\n  }\n  /**\r\n   * Handle Http operation that failed.\r\n   * Let the app continue.\r\n   *\r\n   * @param operation - name of the operation that failed\r\n   * @param result - optional value to return as the observable result\r\n   */\n  handleError(operation = 'operation', result) {\n    return error => {\n      // TODO: send the error to remote logging infrastructure\n      console.error(error); // log to console instead\n      // TODO: better job of transforming error for user consumption\n      this.log(`${operation} failed: ${error.message}`);\n      // Let the app keep running by returning an empty result.\n      return of(result);\n    };\n  }\n  /** Log a ProductService message with the MessageService */\n  log(message) {\n    this.messageService.add(`ShoppingCartService: ${message}`);\n  }\n}\nShoppingCartService.ɵfac = function ShoppingCartService_Factory(t) {\n  return new (t || ShoppingCartService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.MessageService), i0.ɵɵinject(i3.SharingService), i0.ɵɵinject(i4.LoginService), i0.ɵɵinject(i5.ProductService), i0.ɵɵinject(i6.Router), i0.ɵɵinject(i7.ProductSharingService));\n};\nShoppingCartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: ShoppingCartService,\n  factory: ShoppingCartService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"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","names":["HttpHeaders","of","catchError","tap","ShoppingCartService","constructor","http","messageService","sharingService","userService","productService","router","productSharingService","headers","navigateToCart","navigateByUrl","getCart","id","url","shoppingCartUrl","get","pipe","_","log","handleError","updateQuantityAdd","productUpdate","name","price","quantity","description","updateProduct","subscribe","product","addToCartMain","console","currentUser","getData","undefined","cart","cartProduct","push","updateUser","setData","getCartLength","length","removeFromCart","firstRemoval","currQuantity","updateCartQuantity","i","foundType","foundProduct","splice","updateQuantityRemove","remCart","l","inventoryListing","getProduct","result","operation","error","message","add","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\raymo\\SWEN261\\team-project-2225-swen-261-03-g-team0\\estore-ui\\src\\app\\shopping-cart.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\n\r\nimport { Observable, of } from 'rxjs';\r\nimport { catchError, tap } from 'rxjs/operators';\r\n\r\nimport { Product } from './product';\r\nimport { ShoppingCart } from './shopping-cart';\r\nimport { Login } from './login';\r\nimport { LoginService } from './login.service';\r\nimport { ProductService } from './product.service';\r\nimport { Router } from '@angular/router';\r\nimport { ProductSharingService } from './product-sharing-service';     \r\nimport { MessageService } from './message.service';\r\nimport { SharingService } from './sharing-service';\r\n\r\n\r\n/**\r\n * Methods for cart functionality, including add and remove product\r\n */\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class ShoppingCartService {\r\n\r\n  private shoppingCartUrl = 'http://localhost:8080/shoppingCart'; \r\n\r\n  currentUser: Login | undefined;\r\n  cart: Product[] | undefined;\r\n  currQuantity: number = 0;\r\n\r\n  httpOptions = {\r\n    headers: new HttpHeaders({ 'Content-Type': 'application/json' })\r\n  };\r\n\r\n  constructor(\r\n    private http: HttpClient,\r\n    private messageService: MessageService,\r\n    private sharingService: SharingService,\r\n    private userService: LoginService,\r\n    private productService: ProductService,\r\n    private router: Router,\r\n    private productSharingService: ProductSharingService\r\n) { }\r\n\r\n  /**\r\n   * directs user to their cart\r\n   */\r\n navigateToCart(){\r\n  this.router.navigateByUrl(\"/cart\");\r\n}\r\n\r\n  /** GET cart from the server */\r\n  getCart(id : number): Observable<ShoppingCart> {\r\n\r\n    const url = `${this.shoppingCartUrl}/${id}`;\r\n\r\n    return this.http.get<ShoppingCart>(url)\r\n      .pipe(\r\n        tap(_ => this.log('fetch shopping cart')),\r\n        catchError(this.handleError<ShoppingCart>('getShoppingCartError'))\r\n      );\r\n  }\r\n\r\n  /**\r\n   * decreases product quantity in inventory by 1\r\n   * helper for addToCartMain()\r\n   * \r\n   * @param productUpdate \r\n   */\r\n  updateQuantityAdd (productUpdate: Product) {\r\n    let id = productUpdate.id;\r\n    let name = productUpdate.name;\r\n    let price = productUpdate.price;\r\n    let quantity = productUpdate.quantity - 1;\r\n    let description = productUpdate.description;\r\n    productUpdate = {id, name, price, quantity, description} as Product;\r\n    this.productService.updateProduct(productUpdate).subscribe(product => productUpdate = product);\r\n  }\r\n\r\n  /**\r\n   * Add product to user's cart and direct them to their cart\r\n   * \r\n   * @param product \r\n   */\r\n  addToCartMain(product: Product) {\r\n    console.log(product);\r\n    this.currentUser = this.sharingService.getData();\r\n    if (this.currentUser != undefined) {\r\n      this.cart = this.currentUser.cart;\r\n      console.log(this.cart);\r\n      let id = product.id;\r\n      let name= product.name;\r\n      let quantity= 1;\r\n      let description= product.description;\r\n      let price= product.price;\r\n      let cartProduct= {id, name, quantity, price, description} as Product;\r\n      this.cart.push(cartProduct);\r\n      this.userService.updateUser(this.currentUser).subscribe(currentUser => this.currentUser = currentUser);\r\n      this.sharingService.setData(this.currentUser);\r\n      this.updateQuantityAdd(product);\r\n      this.navigateToCart();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * returns length of cart\r\n   * @param cart \r\n   * @returns \r\n   */\r\n  getCartLength(cart: Product[]): number {\r\n    return cart.length;\r\n  }\r\n\r\n  /**\r\n   * Removes the product from the user's cart\r\n   * \r\n   * @param product\r\n   */\r\n   removeFromCart(product: Product) {\r\n     this.currentUser = this.sharingService.getData();\r\n     let firstRemoval = this.productSharingService.getData()[1];\r\n     if (firstRemoval) {\r\n      this.currQuantity = this.productSharingService.getData()[0];\r\n     }\r\n     else {\r\n       this.currQuantity++;\r\n     }\r\n     if (this.currentUser != undefined) {\r\n       this.cart = this.currentUser.cart;\r\n        length = this.getCartLength(this.cart);\r\n        this.updateCartQuantity(this.cart, product, this.currQuantity);\r\n        var i: number;\r\n        let foundType = false\r\n        let foundProduct = false;\r\n      \r\n        for (i = length - 1; i >= 0; i--) {\r\n          if (this.cart[i].name === product.name) {\r\n            if (!foundType) {\r\n              this.currQuantity = this.cart[i].quantity;\r\n              foundType = true;\r\n            }\r\n          }\r\n        }\r\n      \r\n        for (i = length - 1; i>= 0; i--) {\r\n          if (product == this.cart[i] && !foundProduct) {\r\n            this.cart.splice(i, 1);\r\n            this.userService.updateUser(this.currentUser).subscribe(currentUser => this.currentUser = currentUser);\r\n            this.sharingService.setData(this.currentUser);\r\n            this.updateQuantityRemove(product, this.currQuantity);\r\n            foundProduct = true;\r\n          }\r\n        }\r\n    }\r\n  }\r\n/**\r\n * Alternate function to remove a product from the cart of the user\r\n * @param product Product to be removed from the cart of the user\r\n */\r\n  remCart(product: Product): void{\r\n    if(this.currentUser){\r\n      let l= this.currentUser.cart.length;\r\n      for(let i=0;i<l;i++){\r\n        if(product.id == this.currentUser.cart[i].id){\r\n          let inventoryListing: Product | undefined;\r\n          this.productService.getProduct(product.id).subscribe(result => inventoryListing= result);\r\n          if(inventoryListing){\r\n            console.log(inventoryListing);\r\n            inventoryListing.quantity+= product.quantity;\r\n            console.log(inventoryListing);\r\n            this.currentUser.cart.splice(i,1);\r\n            console.log(this.currentUser.cart[i]);\r\n            this.productService.updateProduct(inventoryListing);\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * updates product with +1 quantity\r\n   * removeFromCart() helper\r\n   * @param productUpdate \r\n   * @param quantity \r\n   */\r\n  updateQuantityRemove(productUpdate: Product, quantity: number) {\r\n    let id = productUpdate.id;\r\n    let name = productUpdate.name;\r\n    let price = productUpdate.price;\r\n    let description = productUpdate.description;\r\n    productUpdate = {id, name, price, quantity, description} as Product;\r\n    this.productService.updateProduct(productUpdate).subscribe(product => productUpdate = product);\r\n  }\r\n\r\n  /**\r\n   * increases the quantity of each product of the same name by 1\r\n   * @param cart \r\n   * @param product \r\n   */\r\n  updateCartQuantity(cart: Product[], product: Product, quantity: number) {\r\n    let length = cart.length;\r\n    for (var i = length - 1; i >= 0; i--){\r\n      if (product.name === cart[i].name) {\r\n        cart[i].quantity = quantity;\r\n        quantity++;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle Http operation that failed.\r\n   * Let the app continue.\r\n   *\r\n   * @param operation - name of the operation that failed\r\n   * @param result - optional value to return as the observable result\r\n   */\r\n  private handleError<T>(operation = 'operation', result?: T) {\r\n    return (error: any): Observable<T> => {\r\n\r\n      // TODO: send the error to remote logging infrastructure\r\n      console.error(error); // log to console instead\r\n\r\n      // TODO: better job of transforming error for user consumption\r\n      this.log(`${operation} failed: ${error.message}`);\r\n\r\n      // Let the app keep running by returning an empty result.\r\n      return of(result as T);\r\n    };\r\n  }\r\n\r\n  /** Log a ProductService message with the MessageService */\r\n  private log(message: string) {\r\n    this.messageService.add(`ShoppingCartService: ${message}`);\r\n  }\r\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}